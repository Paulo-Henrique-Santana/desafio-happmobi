<div class="home-container">
  <div class="page-header page-header--user">
    <div class="header-content">
      <div class="user-info">
        <app-photo-upload 
          [photoPreview]="user.photo" 
          [rounded]="true"
          [readonly]="true"
          [size]="'small'"
        />
        <p class="greeting">Olá, {{ user.name }}</p>
      </div>
    </div>
  </div>

  <div class="content">
    <div class="search-section">
      <div class="search-bar">
        <img src="/assets/images/search-icon.svg" alt="Buscar" class="search-icon" />
        <input 
          type="text" 
          placeholder="Buscar carro" 
          class="search-input"
          [(ngModel)]="searchQuery"
          (ngModelChange)="onSearchChange($event)"
        />
      </div>
      
      <button class="filter-button" (click)="openFilterModal()">
        <img src="/assets/images/filter-icon.svg" alt="Filtrar" class="filter-icon" />
        <span>Filtrar</span>
      </button>
    </div>

    @if (showLastReservations) {
      <h2 class="section-title">Últimas reservas</h2>
    } @else {
      <h2 class="section-title">Resultados da busca</h2>
    }

    <div class="vehicles-list">
      @for (vehicle of vehicles; track vehicle.id) {
        <app-vehicle-card 
          [vehicle]="vehicle" 
          [isReserved]="isVehicleReserved(vehicle.id)"
          [reservationId]="getReservationId(vehicle.id)"
          (reserveVehicle)="openReservationModal($event)"
          (cancelReservation)="onCancelReservation($event)"
        />
      }
    </div>
  </div>

  <app-filter-modal
    [isOpen]="isFilterModalOpen"
    [activeFilters]="activeFilters"
    (closeModal)="closeFilterModal()"
    (applyFilters)="applyFilters($event)"
  />

  <app-reservation-modal
    [isOpen]="isReservationModalOpen"
    [vehicle]="selectedVehicle"
    (closeModal)="closeReservationModal()"
    (reservationSuccess)="onReservationSuccess()"
  />

  <app-navigation />
</div>
